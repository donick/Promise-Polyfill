/*!
 * @overview Promise-Polyfill JavaScript Library
 *
 * @copyright Donick Li
 * @author Donick Li <donick.li@gmail.com>
 * @license Released under the MIT license
 * https://github.com/donick/Promise-Polyfill
 * @version v1.1.5
 * Date: 2016-06-25T0:23Z
 */
(function(){"use strict";function t(t,n){return t.hasOwnProperty(n)}function n(t){return"string"==typeof t}function i(t){return"function"==typeof t}function e(t){return/(String|Array)/.test(Object.prototype.toString.call(t))}function o(t){return t&&"function"==typeof t.then}function u(){var t=b.Promise;return i(t)&&(""+t).indexOf("[native code]")?!0:!1}function r(){return"promise-"+N++}function f(i){return n(i)?(t(A,i)||(A[i]={}),A[i]):i instanceof s?A[i.id]:void 0}function c(n,i){function e(n){return t(i,n)?i[n]:o[n]}var o=f(n);o.id=n,o.status=e("status"),o.value=e("value"),o.next=e("next")}function s(t){function n(t){var n=o.id,i=f(n);i.status===P[0]&&(c(n,{status:P[1],value:t}),a(n))}function e(t){var n=o.id,i=f(n),e=i.next.length;if(i.status===P[0]){if(c(n,{status:P[2],value:t}),!e)throw"(in promise) "+t;a(n)}}if(!(this instanceof s))throw j.isNotInstance;if(!i(t))throw j.isNotFunction;var o=this,u=this.id=r();c(u,{status:P[0],value:void 0,next:[]}),setTimeout(function(){var i=f(o),u=i.next.length;try{t(n,e)}catch(r){if(i.status===P[1])return;if(!u){if(i.status===P[2])throw r;throw"(in promise) "+r}e(r)}},0)}function a(t){for(var n=f(t).next;n.length;)setTimeout(n.shift(),0)}function v(t){return new s(function(n,i){t(n,i)})}function l(t,i){function e(t,n,e){if(c[n]=e,t){if(--f)return;i(!0,c)}else{if(a)return;a=!0,i(!1,e)}}var u,r=t.length,f=r,c=[],a=!1;if(n(t))i(!0,t.split(""));else for(var v=0;r>v&&!a;v++)u=t[v],o(u)?u.then(function(t){return function(n){e(!0,t,n)}}(v),function(t){return function(n){e(!1,t,n)}}(v)):s.resolve({i:v,item:u}).then(function(t){e(!0,t.i,t.item)})}function h(t){var n;if(e(t))return l(t,function(t,i){return n?void n(t,i):void(n=function(n,e){t?n(i):e(i)})}),v(function(t,i){return n?void n(t,i):void(n=function(n,e){n?t(e):i(e)})})}function d(t,i){function e(t,n){f||(f=!0,t?i(!0,n):i(!1,n))}var u,r=t.length,f=!1;if(n(t))i(!0,t.charAt(0));else for(var c=0;r>c&&!f;c++)u=t[c],o(u)?u.then(function(t){e(!0,t)},function(t){e(!1,t)}):s.resolve(u).then(function(t){e(!0,t)})}function p(t){var n;if(e(t))return d(t,function(t,i){return n?void n(t,i):void(n=function(n,e){t?n(i):e(i)})}),v(function(t,i){return n?void n(t,i):void(n=function(n,e){n?t(e):i(e)})})}function m(t){return o(t)?t:v(function(n){n(t)})}function y(t){return v(function(n,i){i(t)})}function x(t,n){function e(r,c){var s=f(u),a=s.status,v=s.value;if(a===P[0])o=function(){e(r,c)};else if(a===P[1])if(i(t))try{v=t(v),w(v,r,c)}catch(l){c(l)}else r(v);else if(a===P[2])if(i(n))try{v=n(v),w(v,r,c)}catch(l){c(l)}else c(v)}var o,u=this,r=f(u),c=r.status;return c===P[0]&&r.next.push(function(){o&&o()}),v(e)}function g(t){function n(u,r){var c=f(o),s=c.status,a=c.value;if(s===P[0])e=function(){n(u,r)};else if(s===P[2])if(i(t))try{a=t(a),w(a,u,r)}catch(v){r(v)}else r(a)}var e,o=this,u=f(o),r=u.status;return r===P[0]&&u.next.push(function(){e&&e()}),v(n)}function w(t,n,i){o(t)?t.then(function(t){n(t)},function(t){i(t)}):n(t)}var P=["pending","resolved","rejected"],j={isNotInstance:"undefined is not a promise",isNotFunction:"Promise resolver undefined is not a function"},N=0,b=this,O="PromisePolyfill",A={};s.all=h,s.race=p,s.reject=y,s.resolve=m,s.$info=function(t,n){if(o(t)){var i=f(t.id),e=n?i[n]:i;return e}},s.prototype={constructor:s,then:x,"catch":g},b&&(b[O]=function(t){if(t){if(u())return b.Promise;b.Promise=s}return s}),"function"==typeof define&&define.amd&&define(O,[],function(){return s}),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=s)}).call(this);
